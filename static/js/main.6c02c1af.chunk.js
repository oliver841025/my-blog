(this["webpackJsonpmy-blog"]=this["webpackJsonpmy-blog"]||[]).push([[0],{42:function(t,e,n){"use strict";n.r(e);var c,r,a,i,s,o,u,b,j,p,d,l=n(0),x=n(21),O=n.n(x),h=n(2),f=n(5),g=n(3),v=n(12),m=n(4),y=Object(l.createContext)(null),w="token",S=function(t){localStorage.setItem(w,t)},k=function(){return localStorage.getItem(w)},z=n(1),C=h.b.div(c||(c=Object(g.a)(["\n  height: 64px;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.1);\n  display: flex;\n  justify-content: space-between;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  padding: 0 32px;\n  box-sizing: border-box;\n"]))),_=h.b.div(r||(r=Object(g.a)(["\n  display: flex;\n  align-items: center;\n  height: 100%;\n"]))),$=h.b.div(a||(a=Object(g.a)(["\n  display: flex;\n  align-items: center;\n\n  "," {\n    margin-left: 32px;\n  }\n"])),_),A=h.b.h2(i||(i=Object(g.a)([""]))),L=h.b.div(s||(s=Object(g.a)(["\n  display: flex;\n  align-items: center;\n"]))),E=Object(h.b)(v.b)(o||(o=Object(g.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 64px;\n  box-sizing: border-box;\n  width: 100px;\n  cursor: pointer;\n  text-decoration: none;\n  color: black;\n\n  ","\n"])),(function(t){return t.$active&&"background: rgba(0,0,0,0.2)"})),J=h.b.div(u||(u=Object(g.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]))),B=function(){var t=Object(l.useContext)(y),e=t.user,n=t.setUser,c=Object(m.g)("/"),r=Object(m.f)();return Object(z.jsxs)(C,{children:[Object(z.jsxs)($,{children:[Object(z.jsx)(A,{children:"MY BLOG"}),Object(z.jsxs)(_,{children:[Object(z.jsx)(E,{to:"/",$active:"/"===c.pathname,children:"\u9996\u9801"}),Object(z.jsx)(E,{to:"/about",$active:"/about"===c.pathname,children:"\u95dc\u65bc"}),Object(z.jsx)(E,{to:"/list",$active:"/list"===c.pathname,children:"\u6587\u7ae0\u5217\u8868"}),e&&Object(z.jsx)(E,{to:"/new-post",$active:"/new-post"===c.pathname,children:"\u767c\u5e03\u6587\u7ae0"})]})]}),Object(z.jsx)(L,{children:Object(z.jsxs)(_,{children:[e&&Object(z.jsx)(E,{to:"/logout",$active:"/logout"===c.pathname,onClick:function(){S(""),n(null),"/"!==c.pathname&&r.push("/")},children:"\u767b\u51fa"}),!e&&Object(z.jsxs)(J,{children:[Object(z.jsx)(E,{to:"/register",$active:"/register"===c.pathname,children:"\u8a3b\u518a"}),Object(z.jsx)(E,{to:"/login",$active:"/login"===c.pathname,children:"\u767b\u5165"})]})]})})]})},P=n(6),T=n.n(P),U=n(10),D="https://student-json-api.lidemy.me",F=function(){var t=Object(U.a)(T.a.mark((function t(){var e,n;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(D,"/posts?_sort=createdAt&_order=desc"));case 2:return e=t.sent,t.next=5,e.json();case 5:return n=t.sent,t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),I=function(){var t=Object(U.a)(T.a.mark((function t(e){var n,c;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(D,"/posts?_sort=createdAt&_order=desc&_page=").concat(e,"&_limit=5"));case 2:return n=t.sent,t.next=5,n.json();case 5:return c=t.sent,t.abrupt("return",c);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),N=function(){var t=Object(U.a)(T.a.mark((function t(){var e,n;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(D,"/posts?_sort=createdAt&_order=desc&_page=1&_limit=5"));case 2:return e=t.sent,n=e.headers.get("x-total-count"),t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),M=function(){var t=Object(U.a)(T.a.mark((function t(e){var n,c;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(D,"/posts/").concat(e));case 2:return n=t.sent,t.next=5,n.json();case 5:return c=t.sent,t.abrupt("return",c);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),G=function(){var t=Object(U.a)(T.a.mark((function t(e,n,c){var r,a;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(D,"/register"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({nickname:c,username:e,password:n})});case 2:return r=t.sent,t.next=5,r.json();case 5:return a=t.sent,t.abrupt("return",a);case 7:case"end":return t.stop()}}),t)})));return function(e,n,c){return t.apply(this,arguments)}}(),Y=function(){var t=Object(U.a)(T.a.mark((function t(e,n){var c,r;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(D,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:e,password:n})});case 2:return c=t.sent,t.next=5,c.json();case 5:return r=t.sent,t.abrupt("return",r);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),q=function(){var t=Object(U.a)(T.a.mark((function t(){var e,n,c;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=k(),t.next=3,fetch("".concat(D,"/me"),{headers:{authorization:"Bearer ".concat(e)}});case 3:return n=t.sent,t.next=6,n.json();case 6:return c=t.sent,t.abrupt("return",c);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),H=function(){var t=Object(U.a)(T.a.mark((function t(e,n){var c,r,a;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=k(),t.next=3,fetch("".concat(D,"/posts"),{method:"POST",headers:{"content-type":"application/json",authorization:"Bearer ".concat(c)},body:JSON.stringify({title:e,body:n})});case 3:return r=t.sent,t.next=6,r.json();case 6:return a=t.sent,t.abrupt("return",a);case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),K=h.b.div(b||(b=Object(g.a)(["\n  width: 80%;\n  margin: 64px auto 0 auto;\n"]))),Q=h.b.div(j||(j=Object(g.a)(["\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n  padding: 16px;\n  border-bottom: 1px solid rgba(1, 12, 34, 0.2);\n"]))),R=Object(h.b)(v.b)(p||(p=Object(g.a)(["\n  text-decoration: none;\n  color: #333;\n  font-size: 24px;\n"]))),V=h.b.p(d||(d=Object(g.a)([""])));function W(t){var e=t.post;return Object(z.jsxs)(Q,{children:[Object(z.jsx)(R,{to:"/posts/".concat(e.id),children:e.title}),Object(z.jsx)(V,{children:new Date(e.createdAt).toLocaleString()})]})}var X,Z,tt,et,nt,ct,rt,at,it,st,ot,ut,bt,jt,pt,dt,lt,xt,Ot,ht,ft,gt,vt=function(){var t=Object(l.useState)([]),e=Object(f.a)(t,2),n=e[0],c=e[1];return Object(l.useEffect)((function(){F().then((function(t){c(t)})).catch((function(t){console.log(t)}))}),[n]),Object(z.jsx)(K,{children:n.map((function(t){return Object(z.jsx)(W,{post:t},t.id)}))})},mt=h.b.div(X||(X=Object(g.a)(["\n  margin-top: 64px;\n"]))),yt=h.b.div(Z||(Z=Object(g.a)(["\n  color: red;\n"]))),wt=function(){var t=Object(l.useContext)(y).setUser,e=Object(l.useState)(""),n=Object(f.a)(e,2),c=n[0],r=n[1],a=Object(l.useState)(""),i=Object(f.a)(a,2),s=i[0],o=i[1],u=Object(l.useState)(),b=Object(f.a)(u,2),j=b[0],p=b[1],d=Object(m.f)(),x=function(){var e=Object(U.a)(T.a.mark((function e(){var n,r;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(null),e.next=3,Y(c,s);case 3:if(0!==(n=e.sent).ok){e.next=6;break}return e.abrupt("return",p(n.message));case 6:return S(n.token),e.next=9,q();case 9:if(1===(r=e.sent).ok){e.next=13;break}return S(null),e.abrupt("return",p(r.message.toString()));case 13:t(r.data),d.push("/");case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(z.jsxs)(mt,{children:[Object(z.jsxs)("form",{onSubmit:x,children:[Object(z.jsxs)("div",{children:["username:"," ",Object(z.jsx)("input",{type:"text",value:c,onChange:function(t){return r(t.target.value)}})]}),Object(z.jsxs)("div",{children:["password:"," ",Object(z.jsx)("input",{type:"password",value:s,onChange:function(t){return o(t.target.value)}})]}),Object(z.jsx)("button",{children:"\u767b\u5165"})]}),j&&Object(z.jsx)(yt,{children:j})]})},St=h.b.div(tt||(tt=Object(g.a)(["\n  margin-top: 96px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]))),kt=function(){return Object(z.jsx)(St,{children:"\u518d\u898b\u6211\u5011\u6703\u60f3\u4f60\u7684"})},zt=h.b.div(et||(et=Object(g.a)(["\n  color: red;\n"]))),Ct=h.b.div(nt||(nt=Object(g.a)(["\n  margin-top: 64px;\n"]))),_t=function(){var t=Object(l.useContext)(y).setUser,e=Object(l.useState)(""),n=Object(f.a)(e,2),c=n[0],r=n[1],a=Object(l.useState)(""),i=Object(f.a)(a,2),s=i[0],o=i[1],u=Object(l.useState)(""),b=Object(f.a)(u,2),j=b[0],p=b[1],d=Object(l.useState)(null),x=Object(f.a)(d,2),O=x[0],h=x[1],g=Object(m.f)(),v=function(){var e=Object(U.a)(T.a.mark((function e(){var n,r;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(null),e.next=3,G(c,s,j);case 3:if(0!==(n=e.sent).ok){e.next=6;break}return e.abrupt("return",h(n.message));case 6:return alert("\u8a3b\u518a\u6210\u529f"),S(n.token),e.next=10,q();case 10:if(1===(r=e.sent).ok){e.next=14;break}return S(null),e.abrupt("return",h(r.message.toString()));case 14:t(r.data),g.push("/");case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(z.jsxs)(Ct,{children:[Object(z.jsxs)("form",{onSubmit:v,children:[Object(z.jsxs)("div",{children:["username:"," ",Object(z.jsx)("input",{type:"text",value:c,onChange:function(t){return r(t.target.value)},onFocus:function(){return h(null)}})]}),Object(z.jsxs)("div",{children:["password:"," ",Object(z.jsx)("input",{type:"password",value:s,onChange:function(t){return o(t.target.value)},onFocus:function(){return h(null)}})]}),Object(z.jsxs)("div",{children:["nickname:"," ",Object(z.jsx)("input",{type:"text",value:j,onChange:function(t){return p(t.target.value)},onFocus:function(){return h(null)}})]}),Object(z.jsx)("button",{children:"\u8a3b\u518a"})]}),O&&Object(z.jsx)(zt,{children:O})]})},$t=h.b.div(ct||(ct=Object(g.a)(["\n  margin-top: 64px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]))),At=h.b.div(rt||(rt=Object(g.a)(["\n  padding: 16px;\n  margin-top: 16px;\n"]))),Lt=function(){return Object(z.jsx)($t,{children:Object(z.jsx)(At,{children:"\u4e00\u6b3e\u57fa\u672c\u7684\u90e8\u843d\u683c\uff0c\u5225\u4ee5\u70ba\u6211\u662f Medium \u5594 O_O"})})},Et=h.b.div(at||(at=Object(g.a)(["\n  margin: 128px auto 60px auto;\n  width: 600px;\n  height: 300px;\n  box-sizing: border-box;\n"]))),Jt=h.b.div(it||(it=Object(g.a)(["\n  display: flex;\n  width: 600px;\n  box-sizing: border-box;\n  }\n"]))),Bt=h.b.input(st||(st=Object(g.a)(["\n  width: 600px;\n  height: 40px;\n  padding: 8px;\n  font-size: 18px;\n"]))),Pt=h.b.textarea(ot||(ot=Object(g.a)(["\n  margin-top: 16px;\n  width: 600px;\n  height: 200px;\n  padding: 8px;\n  font-size: 18px;\n"]))),Tt=h.b.button(ut||(ut=Object(g.a)(["\n  margin-top: 16px;\n  padding: 8px;\n  font-size: 16px;\n"]))),Ut=h.b.div(bt||(bt=Object(g.a)(["\n  color: red;\n"]))),Dt=h.b.div(jt||(jt=Object(g.a)(["\n  display: flex;\n  position: fixed;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  background: rgba(0, 0, 0, 0.5);\n  color: white;\n  font-size: 30px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]))),Ft=function(){var t=Object(l.useState)(""),e=Object(f.a)(t,2),n=e[0],c=e[1],r=Object(l.useState)(""),a=Object(f.a)(r,2),i=a[0],s=a[1],o=Object(l.useState)(null),u=Object(f.a)(o,2),b=u[0],j=u[1],p=Object(l.useState)(!1),d=Object(f.a)(p,2),x=d[0],O=d[1],h=Object(l.useContext)(y).user,g=Object(m.f)();h||g.push("/");return Object(z.jsxs)(Et,{children:[x&&Object(z.jsx)(Dt,{children:"Loading..."}),h&&Object(z.jsxs)("form",{onSubmit:function(){if(!x){if(h){if(!n||!i)return j("\u8acb\u52ff\u7559\u767d");O(!0),H(n,i).then((function(t){O(!1),console.log(t)})).catch((function(t){O(!1),j(t)})),c(""),s(""),g.push("/")}g.push("/")}},children:[Object(z.jsx)(Jt,{children:Object(z.jsx)(Bt,{type:"text",placeholder:"\u6a19\u984c",value:n,onChange:function(t){c(t.target.value)}})}),Object(z.jsx)(Jt,{children:Object(z.jsx)(Pt,{type:"text",placeholder:"\u5167\u6587",value:i,onChange:function(t){s(t.target.value)}})}),Object(z.jsx)(Tt,{children:"\u767c\u5e03\u6587\u7ae0"}),b&&Object(z.jsx)(Ut,{children:b})]})]})},It=n(13),Nt=n.n(It),Mt=h.b.div(pt||(pt=Object(g.a)(["\n  width: 80%;\n  margin: 64px auto 0 auto;\n"]))),Gt=h.b.div(dt||(dt=Object(g.a)(["\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n  padding: 16px;\n  border-bottom: 1px solid rgba(1, 12, 34, 0.2);\n"]))),Yt=Object(h.b)(v.b)(lt||(lt=Object(g.a)(["\n  text-decoration: none;\n  color: #333;\n  font-size: 24px;\n"]))),qt=h.b.p(xt||(xt=Object(g.a)([""]))),Ht=h.b.div(Ot||(Ot=Object(g.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-around;\n  margin-top: 16px;\n"]))),Kt=h.b.button(ht||(ht=Object(g.a)(["\n  padding: 8px 16px;\n  font-size: 16px;\n  box-sizing: border-box;\n"]))),Qt=h.b.button(ft||(ft=Object(g.a)(["\n  padding: 8px 16px;\n  font-size: 16px;\n  box-sizing: border-box;\n"]))),Rt=h.b.div(gt||(gt=Object(g.a)(["\n  display: flex;\n  position: fixed;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  background: rgba(0, 0, 0, 0.5);\n  color: white;\n  font-size: 30px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]))),Vt=function(t){var e=t.post;return Object(z.jsxs)(Gt,{children:[Object(z.jsx)(Yt,{to:"/posts/".concat(e.id),children:e.title}),Object(z.jsx)(qt,{children:new Date(e.createdAt).toLocaleString()})]})};Vt.protoTypes={post:Nt.a.object};var Wt,Xt,Zt,te,ee,ne,ce=function(){var t=Object(l.useState)([]),e=Object(f.a)(t,2),n=e[0],c=e[1],r=Object(l.useState)(null),a=Object(f.a)(r,2),i=a[0],s=a[1],o=Object(l.useState)(!1),u=Object(f.a)(o,2),b=u[0],j=u[1],p=Object(l.useState)(1),d=Object(f.a)(p,2),x=d[0],O=d[1];return Object(l.useEffect)((function(){b||(j(!0),I(x).then((function(t){j(!1),c(t),console.log(x),console.log(x*t.length)})).catch((function(t){j(!1),alert(t)})),N().then((function(t){s(t)})).catch((function(t){console.log(t)})))}),[x]),Object(z.jsxs)(Mt,{children:[b&&Object(z.jsx)(Rt,{children:"Loading..."}),n.map((function(t){return Object(z.jsx)(Vt,{post:t},t.id)})),Object(z.jsxs)(Ht,{children:[!b&&x<=1&&Object(z.jsx)("div",{children:"\u9019\u662f\u7b2c\u4e00\u9801\u56c9"}),!b&&x>=2&&Object(z.jsx)(Qt,{onClick:function(){x<=1||O(x-1)},children:"\u4e0a\u4e00\u9801"}),!b&&x>i/5&&Object(z.jsx)("div",{children:"\u9019\u662f\u6700\u5f8c\u4e00\u9801\u56c9"}),!b&&x<=i/5&&Object(z.jsx)(Kt,{onClick:function(){x<=i/5&&O(x+1)},children:"\u4e0b\u4e00\u9801"})]})]})},re=h.b.div(Wt||(Wt=Object(g.a)(["\n  padding: 0 30px;\n  max-width: 960px;\n  margin: 8px auto;\n  margin-top: 96px;\n"]))),ae=h.b.div(Xt||(Xt=Object(g.a)(["\n  margin-bottom: 16px;\n  padding: 16px 0;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.1);\n"]))),ie=h.b.div(Zt||(Zt=Object(g.a)(["\n  font-size: 20px;\n  letter-spacing: 3px;\n  line-height: 1.5;\n"]))),se=h.b.div(te||(te=Object(g.a)(["\n  font-size: 32px;\n  font-weight: 700;\n"]))),oe=h.b.div(ee||(ee=Object(g.a)(["\n  font-size: 16px;\n  color: rgba(0, 0, 0, 0.4);\n  margin-top: 16px;\n"]))),ue=function(t){var e=t.post;return Object(z.jsxs)("div",{children:[Object(z.jsxs)(ae,{children:[Object(z.jsx)(se,{children:e&&e.title}),Object(z.jsx)(oe,{children:e&&new Date(e.createdAt).toLocaleString()})]}),Object(z.jsx)(ie,{children:e&&e.body})]})},be=function(){var t=Object(l.useState)(null),e=Object(f.a)(t,2),n=e[0],c=e[1],r=Object(m.h)().id;return Object(l.useEffect)((function(){M(r).then((function(t){return c(t)})).catch((function(t){console.log(t)}))}),[r]),Object(z.jsx)(re,{children:Object(z.jsx)(ue,{post:n})})},je=h.b.div(ne||(ne=Object(g.a)([""]))),pe=function(){var t=Object(l.useState)(""),e=Object(f.a)(t,2),n=e[0],c=e[1];return Object(l.useEffect)((function(){k()&&q().then((function(t){t.ok&&c(t.data)}))}),[]),Object(z.jsx)(y.Provider,{value:{user:n,setUser:c},children:Object(z.jsx)(je,{children:Object(z.jsxs)(v.a,{children:[Object(z.jsx)(B,{}),Object(z.jsxs)(m.c,{children:[Object(z.jsx)(m.a,{exact:!0,path:"/",children:Object(z.jsx)(vt,{})}),Object(z.jsx)(m.a,{path:"/login",children:Object(z.jsx)(wt,{})}),Object(z.jsx)(m.a,{path:"/logout",children:Object(z.jsx)(kt,{})}),Object(z.jsx)(m.a,{path:"/register",children:Object(z.jsx)(_t,{})}),Object(z.jsx)(m.a,{path:"/about",children:Object(z.jsx)(Lt,{})}),Object(z.jsx)(m.a,{path:"/new-post",children:Object(z.jsx)(Ft,{})}),Object(z.jsx)(m.a,{path:"/list",children:Object(z.jsx)(ce,{})}),Object(z.jsx)(m.a,{path:"/posts/:id",children:Object(z.jsx)(be,{})})]})]})})})};O.a.render(Object(z.jsx)(h.a,{theme:{colors:{primary_300:"#3333dd"}},children:Object(z.jsx)(pe,{})}),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.6c02c1af.chunk.js.map